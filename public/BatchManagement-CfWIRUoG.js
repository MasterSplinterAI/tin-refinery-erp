import{h as B,k as h,l as T,f as l,o as d,F as N,p as P,b as m,t as y,n as L,u as f,j as k,a as v,W as g}from"./app-8R1G56o3.js";import{_ as K,a as M}from"./BatchList.vue_vue_type_script_setup_true_lang-BHdD_nEZ.js";const A={en:{batchNumber:"Batch Number",date:"Date",processes:"Processes",process:"Process",status:"Status",actions:"Actions",edit:"Edit",delete:"Delete",cancel:"Cancel",completed:"Completed",inProgress:"In Progress",canceled:"Canceled",deleteBatch:"Delete Batch",confirmDelete:"Are you sure you want to delete batch",refiningStep:"Refining Step",removeStep:"Remove Step",inputTin:"Input Tin",inputSlag:"Input Slag",outputTin:"Output Tin",slag:"Slag",kilos:"Kilos",snContent:"Sn Content",notes:"Notes",save:"Save",addProcess:"Add Process",batchManagement:"Batch Management",newBatch:"New Batch"},es:{batchNumber:"Número de Lote",date:"Fecha",processes:"Procesos",process:"Proceso",status:"Estado",actions:"Acciones",edit:"Editar",delete:"Eliminar",cancel:"Cancelar",completed:"Completado",inProgress:"En Progreso",canceled:"Cancelado",deleteBatch:"Eliminar Lote",confirmDelete:"¿Está seguro que desea eliminar el lote",refiningStep:"Paso de Refinación",removeStep:"Eliminar Paso",inputTin:"Estaño de Entrada",inputSlag:"Escoria de Entrada",outputTin:"Estaño de Salida",slag:"Escoria",kilos:"Kilos",snContent:"Contenido Sn",notes:"Notas",save:"Guardar",addProcess:"Agregar Proceso",batchManagement:"Gestión de Lotes",newBatch:"Nuevo Lote"}},S=h("en");function w(){const b=n=>{S.value=n},c=n=>A[S.value][n]||n,s=B(()=>S.value);return{t:c,setLanguage:b,language:s}}const R={class:"flex items-center space-x-2"},$=["onClick"],q=T({__name:"LanguageSwitcher",setup(b){const{setLanguage:c,language:s}=w(),n=["en","es"],o=s,r=p=>{c(p)};return(p,_)=>(d(),l("div",R,[(d(),l(N,null,P(n,u=>m("button",{key:u,onClick:C=>r(u),class:L(["px-3 py-1 rounded-md text-sm font-medium",f(o)===u?"bg-indigo-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"])},y(u.toUpperCase()),11,$)),64))]))}}),j={class:"container mx-auto px-4 py-8"},F={class:"flex justify-between items-center mb-8"},X={class:"text-3xl font-bold"},W={key:0,class:"mb-8"},D={key:1,class:"mb-8"},O=T({__name:"BatchManagement",setup(b){const{t:c}=w(),s=h([]),n=h(!1),o=h();k(async()=>{await r()});const r=async()=>{try{const e=await fetch(route("api.batches.index"),{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const a=await e.json();s.value=a}catch(e){console.error("Error fetching batches:",e)}},p=async e=>{var a;try{console.log("Submitting batch data:",e);const i=o.value?"put":"post",I=o.value?route("api.batches.update",{batch:o.value.id}):route("api.batches.store");console.log("Making request to:",I,"with method:",i);const x={batchNumber:e.batchNumber,date:e.date,status:e.status,notes:e.notes,processes:e.processes.map(t=>({processNumber:t.processNumber,processingType:t.processingType,inputTinKilos:t.inputTinKilos,inputTinSnContent:t.inputTinSnContent,inputTinInventoryItemId:t.inputTinInventoryItemId,outputTinKilos:t.outputTinKilos,outputTinSnContent:t.outputTinSnContent,outputTinInventoryItemId:t.outputTinInventoryItemId,inputSlagKilos:t.inputSlagKilos,inputSlagSnContent:t.inputSlagSnContent,inputSlagInventoryItemId:t.inputSlagInventoryItemId,outputSlagKilos:t.outputSlagKilos,outputSlagSnContent:t.outputSlagSnContent,outputSlagInventoryItemId:t.outputSlagInventoryItemId,notes:t.notes}))};g.visit(I,{method:i,data:x,headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest","Content-Type":"application/json","X-CSRF-TOKEN":((a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.getAttribute("content"))||""},preserveState:!0,preserveScroll:!0,onSuccess:()=>{r(),n.value=!1,o.value=void 0},onError:t=>{var E;console.error("Error saving batch:",t),((E=t==null?void 0:t.response)==null?void 0:E.status)===401&&g.visit(route("login"))}})}catch(i){console.error("Error saving batch:",i)}},_=async(e,a)=>{try{await g.put(route("api.batches.update-status",{batch:e}),{status:a}),await r()}catch(i){console.error("Error updating batch status:",i)}},u=e=>{o.value=e,n.value=!0},C=async e=>{try{await g.delete(route("api.batches.destroy",{batch:e})),await r()}catch(a){console.error("Error deleting batch:",a)}};return(e,a)=>(d(),l("div",j,[m("div",F,[m("h1",X,y(f(c)("batchManagement")),1),v(q)]),n.value?(d(),l("div",W,[v(K,{"existing-batch":o.value,"existing-batches":s.value,onSubmit:p},null,8,["existing-batch","existing-batches"])])):(d(),l("div",D,[m("button",{onClick:a[0]||(a[0]=i=>n.value=!0),class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"},y(f(c)("newBatch")),1)])),v(M,{batches:s.value,onStatusChange:_,onEdit:u,onDelete:C},null,8,["batches"])]))}});export{O as default};
